{"version":3,"sources":["../src/modal.js"],"names":["init","require","$","ModalFactory","ModalEvents","ajax","notification","trigger","create","type","types","SAVE_CANCEL","title","body","done","modal","getRoot","on","save","e","preventDefault","usernameid","usernameidField","document","getElementById","push","value","toString","promises","call","methodname","args","field","values","data","isEmptyObject","alert","createPerson","fail","exception","userRow","newPerson","lastaccess","country","username","lastname","firstname","email","suspended","firstaccess","city","newPersonAttribute","Date","i","length","createElement","innerHTML","firstChild","parentElement","appendChild","forEach","x","lastChild"],"mappings":"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","sourcesContent":["export const init = () => {\n\n    require([\"jquery\", \"core/modal_factory\", 'core/modal_events', 'core/ajax', 'core/notification'],\n        function($, ModalFactory, ModalEvents, ajax, notification) {\n            let trigger = $('#create-modal');\n\n            ModalFactory.create({\n                type: ModalFactory.types.SAVE_CANCEL,\n                title: \"Informaci√≥n sobre usuarios\", // Your modal title.\n                body: '<form>\\n' +\n                    '    <label>Ingresa el nombre de usuario\\n' +\n                    '        <input id=\"username-input\" name=\"user\" type=\"text\">\\n' +\n                    '    </label>\\n' +\n                    '</form>',\n            }, trigger)\n                .done(function(modal) {\n\n                    modal.getRoot().on(ModalEvents.save, function(e) {\n                        e.preventDefault();\n                        // Console.log(Object.values(modal.getRoot()));\n                        let usernameid = [],\n                            usernameidField = document.getElementById('username-input');\n\n                        usernameid.push(usernameidField.value.toString());\n                        usernameidField.value = '';\n\n                        let promises = ajax.call([{\n                            methodname: 'core_user_get_users_by_field',\n                            args: {field: 'username', values: usernameid}\n                        }]);\n                        promises[0].done(function(data) {\n\n                            // Console.log(data[0]);\n                            if ($.isEmptyObject(data[0])) {\n                                notification.alert('El usuario no existe', 'El usuario que estas intentando buscar ' +\n                                    'no existe, o no estas autorizad@ para verlo');\n                            } else {\n                                createPerson(data[0]);\n                            }\n                        }).fail(\n                            function(e) {\n                                notification.exception(e);\n                            }\n                        );\n                    });\n\n\n                });\n        });\n\n\n};\n\n// eslint-disable-next-line valid-jsdoc,require-jsdoc\nfunction createPerson(data) {\n\n    let userRow = document.getElementById(\"user-row\");\n    let newPerson = [];\n    const {lastaccess, country, username, lastname, firstname, email, suspended, firstaccess, city} = data;\n\n\n    const newPersonAttribute = [username, firstname, lastname, email,\n        `${country} - ${city}`, new Date(firstaccess * 1000), new Date(lastaccess * 1000), suspended];\n\n    // While (userRow.firstChild) {\n    //     userRow.removeChild(userRow.firstChild);\n    // }\n\n\n    for (let i = 0; i < newPersonAttribute.length; i++) {\n        newPerson[i] = document.createElement('td');\n        newPerson[i].innerHTML = newPersonAttribute[i];\n    }\n\n    if (userRow.firstChild) {\n        userRow.parentElement.appendChild(document.createElement('tr'));\n        newPerson.forEach(x => userRow.parentElement.lastChild.appendChild(x));\n\n    } else {\n\n        newPerson.forEach(x => userRow.appendChild(x));\n    }\n}\n"],"file":"modal.min.js"}